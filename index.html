document.addEventListener('DOMContentLoaded', () => {
  const user = JSON.parse(localStorage.getItem('user'));
  const path = window.location.pathname;

  // Rutas públicas permitidas sin login
  const publicRoutes = ['/login.html', '/register.html', '/not_found.html', '/'];

  // Rutas protegidas solo para admin
  const adminRoutes = ['/views/dashboard.html'];

  // Si NO hay usuario y quiere acceder a una ruta protegida
  if (!user && !publicRoutes.includes(path)) {
    window.location.href = '/views/not_found.html';
    return;
  }

  // Si SÍ hay usuario logueado e intenta ir a login o register
  if (user && (path.includes('/login.html') || path.includes('/register.html'))) {
    window.location.href = '/views/dashboard.html';
    return;
  }

  // Si el usuario NO es admin e intenta acceder al dashboard admin
  if (user && user.role !== 'admin' && adminRoutes.includes(path)) {
    window.location.href = '/views/not_found.html';
    return;
  }

  // Si llega aquí, la ruta está permitida
});